card.innerHTML = `
  <div class="task-header">ATA ${t.ata}</div>

  <div class="block task-meta"><b>Task Card Num / AMM Ref:</b> ${t.card}</div>
  <div class="block task-desc"><b>Task Description:</b> ${t.description}</div>
  <div class="block task-tools"><b>Tools / Testset:</b> ${t.tools}</div>
  <div class="block task-cons"><b>Consumables / MSL:</b> ${t.consumables}</div>
  <div class="block task-remarks"><b>Remarks:</b> ${t.remarks}</div>
  
  <div class="row">
    <div class="meta-pill">Duration / Manhour: ${t.manhour || "N/A"}</div>
    <div class="meta-pill">Due: ${t.due || "N/A"}</div>
    <div class="meta-pill">Assigned To: <span class="${t.assignedTo ? 'assigned-bold':''}">${t.assignedTo || "None"}</span></div>
  </div>

  <div class="task-actions">
    ${ currentUser?.role==="OFFICER"
      ? `Assign:
          <select onchange="assign(${indexInAll(i,filtered)}, this.value)">
            <option value="">Assign to...</option>
            ${staffNames.map(n=>`<option value="${n}" ${t.assignedTo===n?'selected':''}>${n}</option>`).join("")}
          </select>` : `` }
    ${ canMark
      ? `<label><input type="checkbox" ${t.done?"checked":""}
            onchange="markDone(${indexInAll(i,filtered)}, this.checked)"> Mark Done</label>` : `` }
  </div>
`;
